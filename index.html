<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <title>Visão Computacional: Lista 1</title>
    <style>
        canvas {
            background: #222;
            display: block;
            margin: 0 auto;
        }
        
        .botoes {
            text-align: center;
            margin-bottom: 10px;
        }
        
        button {
            margin: 5px;
            padding: 8px 14px;
            font-size: 15px;
            border: none;
            background-color: #007bff;
            color: white;
            border-radius: 5px;
            cursor: pointer;
        }
        
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>

<body>
    <div class="botoes">
        <!-- Questões da Lista 1 -->
        <button onclick="iniciarCanny()">Detecção de Bordas (Canny)</button>
        <button onclick="window.open('questoes/canny.html', '_blank')">Abrir em Nova Aba</button>
        <button onclick="window.open('questoes/pre-processamento.html', '_blank')">Canny + Pré-processamento (Nova Aba)</button>
        <button onclick="window.open('questoes/canny_grupo2.html', '_blank')">Canny + Pré-processamento (Grupo 2 - Nova Aba)</button>
        <button onclick="window.open('questoes/meanshift.html', '_blank')">Segmentação Mean Shift (Nova Aba)</button>
        <button onclick="window.open('questoes/meanshift_canny_grupo1.html', '_blank')">Mean Shift + Canny (Grupo 1 - Nova Aba)</button>
        <button onclick="window.open('questoes/meanshift_canny_grupo2.html', '_blank')">Mean Shift + Canny (Grupo 2 - Nova Aba)</button>
    </div>

    <canvas id="canvas" width="800" height="600"></canvas>

    <script>
        const canvas = document.getElementById("canvas");
        let animFrameIdRef = {
            id: null
        };

        function limparCanvas() {
            const ctx = canvas.getContext("2d");
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function pararAnimacao() {
            if (animFrameIdRef.id) {
                cancelAnimationFrame(animFrameIdRef.id);
                animFrameIdRef.id = null;
            }

            // Limpar script anterior (caso tenha cleanup)
            if (typeof window.cleanupCanny === 'function') {
                window.cleanupCanny();
                window.cleanupCanny = null;
            }
        }

        function carregarScript(scriptName) {
            pararAnimacao();
            limparCanvas();

            // Remover script anterior se existir
            const oldScript = document.getElementById("scriptQuestao");
            if (oldScript) oldScript.remove();

            // Criar novo script
            const script = document.createElement("script");
            script.src = `questoes/${scriptName}.js`;
            script.id = "scriptQuestao";
            script.onload = function() {
                const funcName = `start${scriptName.charAt(0).toUpperCase() + scriptName.slice(1)}`;
                if (typeof window[funcName] === "function") {
                    const cleanup = window[funcName](canvas, animFrameIdRef);
                    if (cleanup) {
                        window[`cleanup${scriptName.charAt(0).toUpperCase() + scriptName.slice(1)}`] = cleanup;
                    }
                }
            };
            document.body.appendChild(script);
        }

        // Função da questão de Canny
        function iniciarCanny() {
            carregarScript('canny');
        }

        // Nenhuma função inicial chamada automaticamente
        limparCanvas();
    </script>
</body>

</html>